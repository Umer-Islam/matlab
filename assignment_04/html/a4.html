
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>a4</title><meta name="generator" content="MATLAB 9.14"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2024-05-24"><meta name="DC.source" content="a4.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">Q1</a></li><li><a href="#3">Q2</a></li><li><a href="#4">Q3</a></li><li><a href="#5">Q4</a></li><li><a href="#6">Q5</a></li></ul></div><pre class="codeinput"><span class="comment">% assignment#4</span>
</pre><h2 id="2">Q1</h2><pre class="codeinput">clearvars,clc,close <span class="string">all</span>;whos

<span class="comment">% Define the IVP parameters</span>
t0 = 0;
x0 = 1;
t_final = 1;
h = 0.5;


f = @(t, x) t ;


t = t0;
x = x0;


<span class="keyword">while</span> t &lt; t_final
    <span class="keyword">if</span> t + h &gt; t_final
        h = t_final - t;
    <span class="keyword">end</span>


    k1 = h * f(t, x);
    k2 = h * f(t + h/2, x + k1/2);
    k3 = h * f(t + h/2, x + k2/2);
    k4 = h * f(t + h, x + k3);


    x = x + (k1 + 2*k2 + 2*k3 + k4) / 6;
    t = t + h;
<span class="keyword">end</span>

<span class="comment">% Display the RK4 result</span>
disp([<span class="string">' value of  x('</span>, num2str(t_final), <span class="string">') = '</span>, num2str(x)])
</pre><pre class="codeoutput"> value of  x(1) = 1.5
</pre><h2 id="3">Q2</h2><pre class="codeinput">clearvars,clc,close <span class="string">all</span>; whos


t0 = 0;
x0 = 0;
v0 = 0;
t_final = 10;
h = 0.5;


t_values = t0:h:t_final;
x_values = zeros(size(t_values));
v_values = zeros(size(t_values));

<span class="comment">% ic</span>
x_values(1) = x0;
v_values(1) = v0;

<span class="comment">% RK4 method to solve the system of ODEs</span>
<span class="keyword">for</span> i = 1:length(t_values) - 1
    t = t_values(i);
    x = x_values(i);
    v = v_values(i);

    m = 321 - 24 * t;
    <span class="keyword">if</span> m &lt;= 0
        <span class="keyword">break</span>;
    <span class="keyword">end</span>

    F = @(v) (5370 - 981 - (v^(3/2) / log(2 + v))) / m;

    k1_v = h * F(v);
    k1_x = h * v;

    k2_v = h * F(v + 0.5 * k1_v);
    k2_x = h * (v + 0.5 * k1_v);

    k3_v = h * F(v + 0.5 * k2_v);
    k3_x = h * (v + 0.5 * k2_v);

    k4_v = h * F(v + k3_v);
    k4_x = h * (v + k3_v);

    v_values(i + 1) = v + (k1_v + 2 * k2_v + 2 * k3_v + k4_v) / 6;
    x_values(i + 1) = x + (k1_x + 2 * k2_x + 2 * k3_x + k4_x) / 6;


    fprintf(<span class="string">'t = %.2f, x = %.4f, v = %.4f\n'</span>, t, x_values(i+1), v_values(i+1))

<span class="keyword">end</span>


figure
subplot(2, 1, 1)
plot(t_values, x_values, <span class="string">'b-'</span>)
xlabel(<span class="string">'Time (s)'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
ylabel(<span class="string">'Height (x)'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
title(<span class="string">'Height vs. Time'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
grid <span class="string">on</span>

subplot(2, 1, 2)
plot(t_values, v_values, <span class="string">'r-'</span>)
xlabel(<span class="string">'Time (s)'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
ylabel(<span class="string">'Velocity (v)'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
title(<span class="string">'Velocity vs. Time'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
grid <span class="string">on</span>
</pre><pre class="codeoutput">t = 0.00, x = 1.7081, v = 6.8304
t = 0.50, x = 6.8942, v = 13.9108
t = 1.00, x = 15.6872, v = 21.2579
t = 1.50, x = 28.2254, v = 28.8910
t = 2.00, x = 44.6574, v = 36.8322
t = 2.50, x = 65.1435, v = 45.1066
t = 3.00, x = 89.8574, v = 53.7426
t = 3.50, x = 118.9883, v = 62.7731
t = 4.00, x = 152.7426, v = 72.2358
t = 4.50, x = 191.3476, v = 82.1742
t = 5.00, x = 235.0540, v = 92.6396
t = 5.50, x = 284.1402, v = 103.6920
t = 6.00, x = 338.9180, v = 115.4031
t = 6.50, x = 399.7381, v = 127.8590
t = 7.00, x = 466.9997, v = 141.1649
t = 7.50, x = 541.1602, v = 155.4506
t = 8.00, x = 622.7510, v = 170.8800
t = 8.50, x = 712.3969, v = 187.6631
t = 9.00, x = 810.8446, v = 206.0770
t = 9.50, x = 919.0047, v = 226.4974
</pre><img vspace="5" hspace="5" src="a4_01.png" alt=""> <h2 id="4">Q3</h2><pre class="codeinput">clc,clearvars,close <span class="string">all</span>;
<span class="comment">% Define the ODE as an anonymous function</span>
ode = @(t, x) sin(x + t^2) ;

<span class="comment">% Define the time span and initial condition</span>
tspan = [-4, 4];
x0 = 0;

<span class="comment">% Solve the ODE using ode45</span>
[t, x] = ode45(ode, tspan, x0);

<span class="comment">% Create a grid for the vector field</span>
[x_grid, t_grid] = meshgrid(linspace(-4, 4, 20), linspace(-4, 4, 20));

<span class="comment">% Compute the vector field</span>
dxdt = sin(x_grid + t_grid.^2);

<span class="comment">% Normalize the vector field for better visualization</span>
dxdt_norm = dxdt ./ sqrt(dxdt.^2 + 1);

disp(<span class="string">' t    |   x'</span>);
disp(<span class="string">'--------------'</span>);
<span class="keyword">for</span> i = 1:length(t)
    fprintf(<span class="string">' %.2f  |  %.4f\n'</span>, t(i), x(i))
<span class="keyword">end</span>

figure
hold <span class="string">on</span>

quiver(t_grid, x_grid, ones(size(t_grid)), dxdt_norm, <span class="string">'r'</span>)

<span class="comment">% Plot the solution curve</span>
plot(t, x, <span class="string">'b'</span>, <span class="string">'LineWidth'</span>, 2)

<span class="comment">% Set plot labels and title</span>
xlabel(<span class="string">'t'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
ylabel(<span class="string">'x'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
title(<span class="string">'Solution and Vector Field of dx/dt = sin(x + t^2)'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
xlim([-4 4])
ylim([-4 4])
grid <span class="string">on</span>
hold <span class="string">off</span>
</pre><pre class="codeoutput"> t    |   x
--------------
 -4.00  |  0.0000
 -4.00  |  -0.0001
 -4.00  |  -0.0001
 -4.00  |  -0.0001
 -4.00  |  -0.0002
 -4.00  |  -0.0004
 -4.00  |  -0.0007
 -4.00  |  -0.0009
 -4.00  |  -0.0011
 -3.99  |  -0.0022
 -3.99  |  -0.0031
 -3.98  |  -0.0038
 -3.98  |  -0.0044
 -3.96  |  -0.0050
 -3.93  |  -0.0018
 -3.91  |  0.0048
 -3.89  |  0.0147
 -3.81  |  0.0747
 -3.73  |  0.1534
 -3.65  |  0.2289
 -3.57  |  0.2808
 -3.52  |  0.2927
 -3.48  |  0.2927
 -3.44  |  0.2805
 -3.40  |  0.2568
 -3.36  |  0.2237
 -3.31  |  0.1844
 -3.27  |  0.1428
 -3.23  |  0.1029
 -3.16  |  0.0520
 -3.10  |  0.0252
 -3.03  |  0.0260
 -2.96  |  0.0525
 -2.90  |  0.0988
 -2.83  |  0.1583
 -2.76  |  0.2242
 -2.70  |  0.2902
 -2.59  |  0.3790
 -2.49  |  0.4349
 -2.38  |  0.4447
 -2.28  |  0.4043
 -2.17  |  0.3088
 -2.05  |  0.1965
 -1.94  |  0.1030
 -1.82  |  0.0517
 -1.72  |  0.0483
 -1.62  |  0.0787
 -1.51  |  0.1356
 -1.41  |  0.2116
 -1.28  |  0.3237
 -1.15  |  0.4466
 -1.02  |  0.5742
 -0.90  |  0.7027
 -0.70  |  0.8933
 -0.51  |  1.0817
 -0.32  |  1.2700
 -0.12  |  1.4600
 0.08  |  1.6602
 0.28  |  1.8544
 0.48  |  2.0270
 0.68  |  2.1572
 0.88  |  2.2235
 1.08  |  2.2155
 1.28  |  2.1333
 1.48  |  1.9878
 1.68  |  1.7996
 1.88  |  1.6049
 2.08  |  1.4591
 2.28  |  1.4345
 2.48  |  1.6035
 2.68  |  1.7627
 2.88  |  1.7372
 3.08  |  1.5552
 3.17  |  1.4672
 3.26  |  1.4023
 3.35  |  1.3792
 3.44  |  1.4084
 3.53  |  1.4868
 3.62  |  1.5726
 3.71  |  1.6251
 3.80  |  1.6219
 3.85  |  1.5960
 3.90  |  1.5577
 3.95  |  1.5115
 4.00  |  1.4626
</pre><img vspace="5" hspace="5" src="a4_02.png" alt=""> <h2 id="5">Q4</h2><pre class="codeinput">clc,clearvars,close <span class="string">all</span>; whos
a = 1.5;    <span class="comment">% absence of predators</span>
c = 0.8;    <span class="comment">% Death rate of predator in the absence of prey</span>
b = 0.1;    <span class="comment">% Effect of predators on prey growth rate</span>
d = 0.1;    <span class="comment">% Effect of prey on predator's growth rate</span>
x0 = 30;    <span class="comment">% Initial prey pop</span>
y0 = 10;    <span class="comment">% Initial predator pop</span>

ode = @(t, y) [a*y(1) - b*y(1)*y(2); -c*y(2) + d*y(1)*y(2)];

tspan = [0, 20];

[t, y] = ode45(ode, tspan, [x0; y0]);

<span class="comment">% Plot</span>
figure
subplot(2, 1, 1)
plot(t, y(:, 1), <span class="string">'b-'</span>)
xlabel(<span class="string">'Time'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
ylabel(<span class="string">'Prey Population'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
title(<span class="string">'Prey Population vs. Time'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
grid <span class="string">on</span>

subplot(2, 1, 2)
plot(t, y(:, 2), <span class="string">'r-'</span>)
xlabel(<span class="string">'Time'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
ylabel(<span class="string">'Predator Population'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
title(<span class="string">'Predator Population vs. Time'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
grid <span class="string">on</span>

<span class="comment">% Phase-plane plot</span>
figure
plot(y(:, 1), y(:, 2), <span class="string">'m'</span>, <span class="string">'LineWidth'</span>, 2)
xlabel(<span class="string">'Prey Population'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
ylabel(<span class="string">'Predator Population'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
title(<span class="string">'Phase Plane Plot'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
grid <span class="string">on</span>
</pre><img vspace="5" hspace="5" src="a4_03.png" alt=""> <img vspace="5" hspace="5" src="a4_04.png" alt=""> <h2 id="6">Q5</h2><pre class="codeinput">clc,close <span class="string">all</span>, clearvars, whos
syms <span class="string">x(t)</span> <span class="string">omega</span>


ode = diff(x, t, 2) + omega^2 * x == 0;
sol = dsolve(ode);
disp(<span class="string">'General Solution:'</span>)
disp(sol)
x0 = sym(<span class="string">'x0'</span>);
v0 = sym(<span class="string">'v0'</span>);
Dx = diff(x, t);

<span class="comment">% Solve DE with ic</span>
conds = [x(0) == x0, Dx(0) == v0];
sol_with_conds = dsolve(ode, conds);

disp(<span class="string">'Solution with Initial Conditions:'</span>)
disp(sol_with_conds)

x_t = matlabFunction(sol_with_conds, <span class="string">'Vars'</span>, [t, omega, x0, v0]);

omega_val = 1;
x0_val = 1;
v0_val = 0;

t_vals = linspace(0, 10, 1000);

x_vals = x_t(t_vals, omega_val, x0_val, v0_val);

figure
plot(t_vals, x_vals)
xlabel(<span class="string">'Time (t)'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
ylabel(<span class="string">'Displacement (x)'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
title(<span class="string">'Simple Harmonic Oscillator'</span>,<span class="string">'interpreter'</span>,<span class="string">'latex'</span>)
grid <span class="string">on</span>
</pre><pre class="codeoutput">General Solution:
C1*exp(-omega*t*1i) + C2*exp(omega*t*1i)
 
Solution with Initial Conditions:
(exp(-omega*t*1i)*(omega*x0 + v0*1i))/(2*omega) - (exp(omega*t*1i)*(- omega*x0 + v0*1i))/(2*omega)
 
</pre><img vspace="5" hspace="5" src="a4_05.png" alt=""> <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2023a</a><br></p></div><!--
##### SOURCE BEGIN #####
% assignment#4

%% Q1
clearvars,clc,close all;whos

% Define the IVP parameters
t0 = 0;     
x0 = 1;      
t_final = 1; 
h = 0.5;    


f = @(t, x) t ; 


t = t0;
x = x0;


while t < t_final
    if t + h > t_final
        h = t_final - t; 
    end

   
    k1 = h * f(t, x);
    k2 = h * f(t + h/2, x + k1/2);
    k3 = h * f(t + h/2, x + k2/2);
    k4 = h * f(t + h, x + k3);


    x = x + (k1 + 2*k2 + 2*k3 + k4) / 6;
    t = t + h;
end

% Display the RK4 result
disp([' value of  x(', num2str(t_final), ') = ', num2str(x)])

%% Q2
clearvars,clc,close all; whos


t0 = 0;         
x0 = 0;         
v0 = 0;         
t_final = 10;   
h = 0.5;      


t_values = t0:h:t_final;
x_values = zeros(size(t_values));
v_values = zeros(size(t_values));

% ic
x_values(1) = x0;
v_values(1) = v0;

% RK4 method to solve the system of ODEs
for i = 1:length(t_values) - 1
    t = t_values(i);
    x = x_values(i);
    v = v_values(i);

    m = 321 - 24 * t;
    if m <= 0
        break;
    end

    F = @(v) (5370 - 981 - (v^(3/2) / log(2 + v))) / m;

    k1_v = h * F(v);
    k1_x = h * v;

    k2_v = h * F(v + 0.5 * k1_v);
    k2_x = h * (v + 0.5 * k1_v);

    k3_v = h * F(v + 0.5 * k2_v);
    k3_x = h * (v + 0.5 * k2_v);

    k4_v = h * F(v + k3_v);
    k4_x = h * (v + k3_v);

    v_values(i + 1) = v + (k1_v + 2 * k2_v + 2 * k3_v + k4_v) / 6;
    x_values(i + 1) = x + (k1_x + 2 * k2_x + 2 * k3_x + k4_x) / 6;

   
    fprintf('t = %.2f, x = %.4f, v = %.4f\n', t, x_values(i+1), v_values(i+1))

end


figure
subplot(2, 1, 1)
plot(t_values, x_values, 'b-')
xlabel('Time (s)','interpreter','latex')
ylabel('Height (x)','interpreter','latex')
title('Height vs. Time','interpreter','latex')
grid on

subplot(2, 1, 2)
plot(t_values, v_values, 'r-')
xlabel('Time (s)','interpreter','latex')
ylabel('Velocity (v)','interpreter','latex')
title('Velocity vs. Time','interpreter','latex')
grid on


%% Q3

clc,clearvars,close all; 
% Define the ODE as an anonymous function
ode = @(t, x) sin(x + t^2) ;

% Define the time span and initial condition
tspan = [-4, 4];
x0 = 0;

% Solve the ODE using ode45
[t, x] = ode45(ode, tspan, x0);

% Create a grid for the vector field
[x_grid, t_grid] = meshgrid(linspace(-4, 4, 20), linspace(-4, 4, 20));

% Compute the vector field
dxdt = sin(x_grid + t_grid.^2);

% Normalize the vector field for better visualization
dxdt_norm = dxdt ./ sqrt(dxdt.^2 + 1);

disp(' t    |   x');
disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
for i = 1:length(t)
    fprintf(' %.2f  |  %.4f\n', t(i), x(i))
end

figure
hold on

quiver(t_grid, x_grid, ones(size(t_grid)), dxdt_norm, 'r')

% Plot the solution curve
plot(t, x, 'b', 'LineWidth', 2)

% Set plot labels and title
xlabel('t','interpreter','latex')
ylabel('x','interpreter','latex')
title('Solution and Vector Field of dx/dt = sin(x + t^2)','interpreter','latex')
xlim([-4 4])
ylim([-4 4])
grid on
hold off
%% Q4
clc,clearvars,close all; whos
a = 1.5;    % absence of predators
c = 0.8;    % Death rate of predator in the absence of prey
b = 0.1;    % Effect of predators on prey growth rate
d = 0.1;    % Effect of prey on predator's growth rate
x0 = 30;    % Initial prey pop
y0 = 10;    % Initial predator pop

ode = @(t, y) [a*y(1) - b*y(1)*y(2); -c*y(2) + d*y(1)*y(2)];

tspan = [0, 20]; 

[t, y] = ode45(ode, tspan, [x0; y0]);

% Plot
figure
subplot(2, 1, 1)
plot(t, y(:, 1), 'b-')
xlabel('Time','interpreter','latex')
ylabel('Prey Population','interpreter','latex')
title('Prey Population vs. Time','interpreter','latex')
grid on

subplot(2, 1, 2)
plot(t, y(:, 2), 'r-')
xlabel('Time','interpreter','latex')
ylabel('Predator Population','interpreter','latex')
title('Predator Population vs. Time','interpreter','latex')
grid on

% Phase-plane plot
figure
plot(y(:, 1), y(:, 2), 'm', 'LineWidth', 2)
xlabel('Prey Population','interpreter','latex')
ylabel('Predator Population','interpreter','latex')
title('Phase Plane Plot','interpreter','latex')
grid on
%% Q5
clc,close all, clearvars, whos
syms x(t) omega


ode = diff(x, t, 2) + omega^2 * x == 0;
sol = dsolve(ode);
disp('General Solution:')
disp(sol)
x0 = sym('x0');
v0 = sym('v0');
Dx = diff(x, t); 

% Solve DE with ic
conds = [x(0) == x0, Dx(0) == v0];
sol_with_conds = dsolve(ode, conds);

disp('Solution with Initial Conditions:')
disp(sol_with_conds)

x_t = matlabFunction(sol_with_conds, 'Vars', [t, omega, x0, v0]);

omega_val = 1; 
x0_val = 1;    
v0_val = 0;    

t_vals = linspace(0, 10, 1000);

x_vals = x_t(t_vals, omega_val, x0_val, v0_val);

figure
plot(t_vals, x_vals)
xlabel('Time (t)','interpreter','latex')
ylabel('Displacement (x)','interpreter','latex')
title('Simple Harmonic Oscillator','interpreter','latex')
grid on
##### SOURCE END #####
--></body></html>